<h2 class="mb-4 text-center">Create Your Account</h2>
<form action="/users/register" method="POST" novalidate autocomplete="off" aria-label="Registration form">
  <div class="mb-4">
    <label for="username" class="form-label fw-semibold">Username</label>
    <input
      type="text"
      name="username"
      id="username"
      class="form-control"
      placeholder="Choose a username"
      required
      minlength="3"
      maxlength="30"
      pattern="^[a-zA-Z0-9._-]{3,30}$"
      aria-describedby="usernameHelp"
      autofocus
    />
    <div id="usernameHelp" class="form-text">
      3-30 characters. Letters, numbers, dots, underscores, and hyphens allowed.
    </div>
  </div>

  <div class="mb-4">
    <label for="email" class="form-label fw-semibold">Email Address</label>
    <input
      type="email"
      name="email"
      id="email"
      class="form-control"
      placeholder="Your email address"
      required
      aria-describedby="emailHelp"
    />
    <div id="emailHelp" class="form-text">
      We'll never share your email with anyone else.
    </div>
  </div>

  <div class="mb-4 position-relative">
    <label for="password" class="form-label fw-semibold">Password</label>
    <input
      type="password"
      name="password"
      id="password"
      class="form-control"
      placeholder="Create a password"
      required
      minlength="8"
      aria-describedby="passwordHelp"
    />
    <button
      type="button"
      class="btn btn-outline-secondary position-absolute top-50 end-0 translate-middle-y me-2"
      id="togglePassword"
      aria-label="Toggle password visibility"
      tabindex="-1"
      style="z-index: 10;"
    >
      👁️
    </button>
    <div id="passwordHelp" class="form-text">
      Minimum 8 characters, including uppercase, lowercase, number, and special character.
    </div>
  </div>

  <div class="mb-4 position-relative">
    <label for="confirmPassword" class="form-label fw-semibold">Confirm Password</label>
    <input
      type="password"
      name="confirmPassword"
      id="confirmPassword"
      class="form-control"
      placeholder="Re-enter your password"
      required
      aria-describedby="confirmPasswordHelp"
    />
    <button
      type="button"
      class="btn btn-outline-secondary position-absolute top-50 end-0 translate-middle-y me-2"
      id="toggleConfirmPassword"
      aria-label="Toggle confirm password visibility"
      tabindex="-1"
      style="z-index: 10;"
    >
      👁️
    </button>
    <div id="confirmPasswordHelp" class="form-text">
      Must match the password entered above.
    </div>
  </div>

  <div class="mb-3 form-check">
    <input type="checkbox" class="form-check-input" id="terms" name="terms" required />
    <label class="form-check-label" for="terms">
      I agree to the <a href="/terms" target="_blank" rel="noopener noreferrer">Terms and Conditions</a>
    </label>
  </div>

  <button type="submit" class="btn btn-primary w-100 py-2 fw-bold">
    Register
  </button>

  <div class="mt-3 text-center">
    Already have an account? <a href="/users/login" class="link-primary">Login here</a>
  </div>
</form>

<script>
  // Toggle password visibility function for both password fields
  function setupTogglePassword(toggleId, inputId) {
    const toggleBtn = document.getElementById(toggleId);
    const input = document.getElementById(inputId);

    toggleBtn.addEventListener('click', () => {
      const type = input.getAttribute('type');
      if (type === 'password') {
        input.setAttribute('type', 'text');
        toggleBtn.textContent = '🙈';
      } else {
        input.setAttribute('type', 'password');
        toggleBtn.textContent = '👁️';
      }
    });
  }

  setupTogglePassword('togglePassword', 'password');
  setupTogglePassword('toggleConfirmPassword', 'confirmPassword');

  // Optional: Client-side password confirmation validation
  const form = document.querySelector('form');
  const passwordInput = document.getElementById('password');
  const confirmPasswordInput = document.getElementById('confirmPassword');

  form.addEventListener('submit', (e) => {
    if (passwordInput.value !== confirmPasswordInput.value) {
      e.preventDefault();
      alert('Passwords do not match. Please try again.');
      confirmPasswordInput.focus();
    }
  });
</script>
